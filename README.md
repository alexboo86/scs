# Secure Content Service

–°–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (PDF, PPT/PPTX) —Å –≤–æ–¥—è–Ω—ã–º–∏ –∑–Ω–∞–∫–∞–º–∏ –¥–ª—è –æ–Ω–ª–∞–π–Ω —à–∫–æ–ª—ã.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤**: PDF, PPT, PPTX  
‚úÖ **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏**: –õ–æ–≥–æ—Ç–∏–ø, —Ç–µ–∫—Å—Ç —à–∫–æ–ª—ã  
‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏**: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, email, IP, –≤—Ä–µ–º—è  
‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è**: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤, –≤—ã–¥–µ–ª–µ–Ω–∏—è, –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à  
‚úÖ **Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ**: –ì–æ—Ç–æ–≤—ã–π –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É  
‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ iframe**: –ü—Ä–æ—Å—Ç–∞—è –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ—Å—Ç—å –≤ –≤–∞—à —Å–∞–π—Ç  
‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞**: Viewer –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤  
‚úÖ **–ú–æ–±–∏–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å  
‚úÖ **–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç—É–ø–∞**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏  

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
cd secure-content-service

# 2. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª
cp env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ —É–∫–∞–∂–∏—Ç–µ SECRET_KEY –∏ –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ Docker Compose
docker-compose up -d

# 4. –°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:8000
# API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8000/docs
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Tilda

–î–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è viewer –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—É Tilda:

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–º–µ–Ω—ã** –≤ `.env`:
   ```env
   ALLOWED_EMBED_DOMAINS=your-site.tilda.ws,your-site.tilda.cc
   REQUIRE_REFERER_CHECK=true
   ```

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥** –∏–∑ `tilda-embed-code.html`

3. **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è** –≤ `TILDA_INTEGRATION.md`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
secure-content-service/
‚îú‚îÄ‚îÄ backend/              # FastAPI backend
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py      # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/         # API endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/      # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/    # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/       # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ frontend/            # Viewer –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îî‚îÄ‚îÄ templates/
‚îÇ       ‚îî‚îÄ‚îÄ viewer.html  # –ó–∞—â–∏—â–µ–Ω–Ω—ã–π viewer
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ env.example
‚îú‚îÄ‚îÄ tilda-embed-code.html  # –ì–æ—Ç–æ–≤—ã–π –∫–æ–¥ –¥–ª—è Tilda
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ QUICKSTART.md        # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É
‚îú‚îÄ‚îÄ INTEGRATION.md       # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ TILDA_INTEGRATION.md # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Tilda
‚îî‚îÄ‚îÄ ARCHITECTURE.md      # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
```

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Backend (FastAPI)

- **API –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**: –ó–∞–≥—Ä—É–∑–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- **API –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **API –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞**: –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- **Embed API**: –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π endpoint –¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è –≤ Tilda
- **–ê–¥–º–∏–Ω API**: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### Viewer (Frontend)

- –ó–∞—â–∏—â–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–∏—Å—Ç–µ–º–∞ –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤

- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ**: –õ–æ–≥–æ—Ç–∏–ø —à–∫–æ–ª—ã (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ**: Email, IP, –≤—Ä–µ–º—è, –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ Referer**: Viewer –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
2. **–¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è**: –ö–∞–∂–¥–∞—è —Å–µ—Å—Å–∏—è –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏**: –¢–æ–∫–µ–Ω—ã –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞**: –ü–µ—Ä–µ–¥ –≤—ã–¥–∞—á–µ–π —Ç–æ–∫–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

1. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—ã–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∞–≤–æ–≥–æ –∫–ª–∏–∫–∞
3. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à (Ctrl+S, Ctrl+P, Print Screen)
4. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ DevTools
5. Blur –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
6. –í–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏ —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üåê API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- **Swagger UI**: `http://localhost:8000/docs`
- **ReDoc**: `http://localhost:8000/redoc`

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞

```bash
curl -X POST http://localhost:8000/api/documents/upload \
  -F "file=@presentation.pdf" \
  -F "name=–ú–æ—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è"
```

### –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞

```bash
curl -X POST http://localhost:8000/api/admin/documents/1/access \
  -F "user_emails=student@school.com"
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ embed URL –¥–ª—è Tilda

```bash
curl "http://localhost:8000/api/viewer/embed?document_token=TOKEN&user_email=user@example.com"
```

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[QUICKSTART.md](QUICKSTART.md)** - –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É
- **[INTEGRATION.md](INTEGRATION.md)** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –≤–∞—à —Å–∞–π—Ç
- **[TILDA_INTEGRATION.md](TILDA_INTEGRATION.md)** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Tilda
- **[ARCHITECTURE.md](ARCHITECTURE.md)** - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ `.env`:

- `SECRET_KEY` - –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è JWT (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç–µ!)
- `ALLOWED_ORIGINS` - –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã –¥–ª—è CORS
- `ALLOWED_EMBED_DOMAINS` - –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã –¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è (Tilda)
- `REQUIRE_REFERER_CHECK` - –í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É Referer (–∑–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
- `MAX_FILE_SIZE` - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
- `TOKEN_EXPIRY_HOURS` - –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞

## üê≥ Docker

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é —á–µ—Ä–µ–∑ Docker:

```bash
docker-compose up -d
```

–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–∫–ª—é—á–µ–Ω—ã –≤ Dockerfile.

## üìù –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose (–¥–ª—è Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è)
- Python 3.11+ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- Poppler (–¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ PDF)
- LibreOffice (–¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ PPT/PPTX)

## ‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

1. **–ò–∑–º–µ–Ω–∏—Ç–µ SECRET_KEY** –≤ `.env`
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS**
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ ALLOWED_ORIGINS** –¥–ª—è –≤–∞—à–∏—Ö –¥–æ–º–µ–Ω–æ–≤
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ ALLOWED_EMBED_DOMAINS** –¥–ª—è –¥–æ–º–µ–Ω–æ–≤ Tilda
5. **–í–∫–ª—é—á–∏—Ç–µ REQUIRE_REFERER_CHECK=true** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
6. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PostgreSQL/MySQL** –≤–º–µ—Å—Ç–æ SQLite –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
7. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã** –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs backend`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API: `http://localhost:8000/docs`
3. –°–º. —Ä–∞–∑–¥–µ–ª Troubleshooting –≤ QUICKSTART.md

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ –¥–ª—è —Å–≤–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.
